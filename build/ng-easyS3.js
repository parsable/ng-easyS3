// Create all modules and define dependencies to make sure they exist
// and are loaded in the correct order to satisfy dependency injection
// before all nested files are concatenated by Grunt

// Config
'use strict';

angular.module('ngS3upload.config', []).value('ngS3upload.config', {
  debug: true
}).config(['$compileProvider', function ($compileProvider) {
  if (angular.isDefined($compileProvider.urlSanitizationWhitelist)) {
    $compileProvider.urlSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/);
  } else {
    $compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/);
  }
}]);

// Modules
angular.module('ngS3upload.directives', []);
angular.module('ngS3upload', ['ngS3upload.config', 'ngS3upload.directives', 'ngS3upload.services', 'ngSanitize']);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9uZy1lYXN5UzMvbmctZWFzeVMzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFLQSxPQUFPLENBQUMsTUFBTSxDQUFDLG1CQUFtQixFQUFFLEVBQUUsQ0FBQyxDQUNyQyxLQUFLLENBQUMsbUJBQW1CLEVBQUU7QUFDdkIsT0FBSyxFQUFFLElBQUk7Q0FDZCxDQUFDLENBQ0YsTUFBTSxDQUFDLENBQUMsa0JBQWtCLEVBQUUsVUFBUyxnQkFBZ0IsRUFBQztBQUNwRCxNQUFJLE9BQU8sQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsd0JBQXdCLENBQUMsRUFBRTtBQUNoRSxvQkFBZ0IsQ0FBQyx3QkFBd0IsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO0dBQ2pGLE1BQU07QUFDTCxvQkFBZ0IsQ0FBQywwQkFBMEIsQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO0dBQ25GO0NBQ0YsQ0FBQyxDQUFDLENBQUM7OztBQUdOLE9BQU8sQ0FBQyxNQUFNLENBQUMsdUJBQXVCLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDNUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQ3ZCLENBQ0ksbUJBQW1CLEVBQ25CLHVCQUF1QixFQUN2QixxQkFBcUIsRUFDckIsWUFBWSxDQUNmLENBQUMsQ0FBQyIsImZpbGUiOiJzcmMvbmctZWFzeVMzL25nLWVhc3lTMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIENyZWF0ZSBhbGwgbW9kdWxlcyBhbmQgZGVmaW5lIGRlcGVuZGVuY2llcyB0byBtYWtlIHN1cmUgdGhleSBleGlzdFxuLy8gYW5kIGFyZSBsb2FkZWQgaW4gdGhlIGNvcnJlY3Qgb3JkZXIgdG8gc2F0aXNmeSBkZXBlbmRlbmN5IGluamVjdGlvblxuLy8gYmVmb3JlIGFsbCBuZXN0ZWQgZmlsZXMgYXJlIGNvbmNhdGVuYXRlZCBieSBHcnVudFxuXG4vLyBDb25maWdcbmFuZ3VsYXIubW9kdWxlKCduZ1MzdXBsb2FkLmNvbmZpZycsIFtdKS5cbiAgdmFsdWUoJ25nUzN1cGxvYWQuY29uZmlnJywge1xuICAgICAgZGVidWc6IHRydWVcbiAgfSkuXG4gIGNvbmZpZyhbJyRjb21waWxlUHJvdmlkZXInLCBmdW5jdGlvbigkY29tcGlsZVByb3ZpZGVyKXtcbiAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoJGNvbXBpbGVQcm92aWRlci51cmxTYW5pdGl6YXRpb25XaGl0ZWxpc3QpKSB7XG4gICAgICAkY29tcGlsZVByb3ZpZGVyLnVybFNhbml0aXphdGlvbldoaXRlbGlzdCgvXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98ZmlsZXxkYXRhKTovKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGNvbXBpbGVQcm92aWRlci5hSHJlZlNhbml0aXphdGlvbldoaXRlbGlzdCgvXlxccyooaHR0cHM/fGZ0cHxtYWlsdG98ZmlsZXxkYXRhKTovKTtcbiAgICB9XG4gIH1dKTtcblxuLy8gTW9kdWxlc1xuYW5ndWxhci5tb2R1bGUoJ25nUzN1cGxvYWQuZGlyZWN0aXZlcycsIFtdKTtcbmFuZ3VsYXIubW9kdWxlKCduZ1MzdXBsb2FkJyxcbiAgICBbXG4gICAgICAgICduZ1MzdXBsb2FkLmNvbmZpZycsXG4gICAgICAgICduZ1MzdXBsb2FkLmRpcmVjdGl2ZXMnLFxuICAgICAgICAnbmdTM3VwbG9hZC5zZXJ2aWNlcycsXG4gICAgICAgICduZ1Nhbml0aXplJ1xuICAgIF0pO1xuIl19;
'use strict';

angular.module('ngS3upload.config', []).constant('ngS3Config', {
  theme: 'bootstrap3'
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9uZy1lYXN5UzMvc2VydmljZXMvczMtY29uZmlnLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRSxFQUFFLENBQUMsQ0FDckMsUUFBUSxDQUFDLFlBQVksRUFBRTtBQUNyQixPQUFLLEVBQUUsWUFBWTtDQUNwQixDQUFDLENBQUMiLCJmaWxlIjoic3JjL25nLWVhc3lTMy9zZXJ2aWNlcy9zMy1jb25maWcuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnbmdTM3VwbG9hZC5jb25maWcnLCBbXSkuXG4gIGNvbnN0YW50KCduZ1MzQ29uZmlnJywge1xuICAgIHRoZW1lOiAnYm9vdHN0cmFwMydcbiAgfSk7XG4iXX0=;
'use strict';

angular.module('ngS3upload.services', []).service('S3Uploader', ['$http', '$q', '$window', '$timeout', function ($http, $q, $window, $timeout) {
  this.uploads = 0;
  var self = this;

  this.getUploadOptions = function (uri) {
    var deferred = $q.defer();
    $http.get(uri).success(function (response, status) {
      deferred.resolve(response);
    }).error(function (error, status) {
      deferred.reject(error);
    });

    return deferred.promise;
  };

  this.randomString = function (length) {
    var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
    var result = '';
    for (var i = length; i > 0; --i) result += chars[Math.round(Math.random() * (chars.length - 1))];

    return result;
  };

  this.upload = function (scope, uri, key, acl, type, accessKey, policy, signature, file) {
    var deferred = $q.defer();
    scope.attempt = true;

    var fd = new FormData();
    fd.append('key', key);
    fd.append('acl', acl);
    fd.append('Content-Type', file.type);
    fd.append('AWSAccessKeyId', accessKey);
    fd.append('policy', policy);
    fd.append('signature', signature);
    fd.append('file', file);

    var xhr = new XMLHttpRequest();
    xhr.upload.addEventListener('progress', uploadProgress, false);
    xhr.addEventListener('load', uploadComplete, false);
    xhr.addEventListener('error', uploadFailed, false);
    xhr.addEventListener('abort', uploadCanceled, false);
    scope.$emit('s3upload:start', xhr);

    // Define event handlers
    function uploadProgress(e) {
      scope.$apply(function () {
        if (e.lengthComputable) {
          scope.progress = Math.round(e.loaded * 100 / e.total);
        } else {
          scope.progress = 'unable to compute';
        }
        var msg = { type: 'progress', value: scope.progress };
        scope.$emit('s3upload:progress', msg);
        if (typeof deferred.notify === 'function') {
          deferred.notify(msg);
        }
      });
    }
    function uploadComplete(e) {
      var xhr = e.srcElement || e.target;
      scope.$apply(function () {
        self.uploads--;
        scope.uploading = false;
        //zero out progress for animation
        $timeout(function () {
          scope.progress = 0;
        }, 300);
        if (xhr.status === 204) {
          // successful upload
          scope.success = true;
          deferred.resolve(xhr);
          scope.$emit('s3upload:success', xhr, { path: uri + key });
        } else {
          scope.success = false;
          deferred.reject(xhr);
          scope.$emit('s3upload:error', xhr);
        }
      });
    }
    function uploadFailed(e) {
      var xhr = e.srcElement || e.target;
      scope.$apply(function () {
        self.uploads--;
        scope.uploading = false;
        scope.success = false;
        deferred.reject(xhr);
        scope.$emit('s3upload:error', xhr);
      });
    }
    function uploadCanceled(e) {
      var xhr = e.srcElement || e.target;
      scope.$apply(function () {
        self.uploads--;
        scope.uploading = false;
        scope.success = false;
        deferred.reject(xhr);
        scope.$emit('s3upload:abort', xhr);
      });
    }

    // Send the file
    scope.uploading = true;
    this.uploads++;
    xhr.open('POST', uri, true);
    xhr.send(fd);

    return deferred.promise;
  };

  this.isUploading = function () {
    return this.uploads > 0;
  };
}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9uZy1lYXN5UzMvc2VydmljZXMvczMtdXBsb2FkZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsTUFBTSxDQUFDLHFCQUFxQixFQUFFLEVBQUUsQ0FBQyxDQUN2QyxPQUFPLENBQUMsWUFBWSxFQUFFLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFVBQVUsS0FBSyxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFO0FBQ25HLE1BQUksQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO0FBQ2pCLE1BQUksSUFBSSxHQUFHLElBQUksQ0FBQzs7QUFFaEIsTUFBSSxDQUFDLGdCQUFnQixHQUFHLFVBQVUsR0FBRyxFQUFFO0FBQ3JDLFFBQUksUUFBUSxHQUFHLEVBQUUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUMxQixTQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUNaLE9BQU8sQ0FBQyxVQUFVLFFBQVEsRUFBRSxNQUFNLEVBQUU7QUFDbEMsY0FBUSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUM1QixDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRTtBQUNoQyxjQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ3hCLENBQUMsQ0FBQzs7QUFFTCxXQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUM7R0FDekIsQ0FBQzs7QUFFRixNQUFJLENBQUMsWUFBWSxHQUFHLFVBQVUsTUFBTSxFQUFFO0FBQ3BDLFFBQUksS0FBSyxHQUFHLGdFQUFnRSxDQUFDO0FBQzdFLFFBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQztBQUNoQixTQUFLLElBQUksQ0FBQyxHQUFHLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLE1BQU0sSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENB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QUFPLEVBQUUsQ0FBQztBQUNmLGFBQUssQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO0FBQ3hCLGFBQUssQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBQ3RCLGdCQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ3JCLGFBQUssQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxDQUFDLENBQUM7T0FDcEMsQ0FBQyxDQUFDO0tBQ0o7OztBQUdELFNBQUssQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO0FBQ3ZCLFFBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztBQUNmLE9BQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUM1QixPQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDOztBQUViLFdBQU8sUUFBUSxDQUFDLE9BQU8sQ0FBQztHQUN6QixDQUFDOztBQUVGLE1BQUksQ0FBQyxXQUFXLEdBQUcsWUFBWTtBQUM3QixXQUFPLElBQUksQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFDO0dBQ3pCLENBQUM7Q0FDSCxDQUFDLENBQUMsQ0FBQyIsImZpbGUiOiJzcmMvbmctZWFzeVMzL3NlcnZpY2VzL3MzLXVwbG9hZGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ25nUzN1cGxvYWQuc2VydmljZXMnLCBbXSkuXG4gIHNlcnZpY2UoJ1MzVXBsb2FkZXInLCBbJyRodHRwJywgJyRxJywgJyR3aW5kb3cnLCAnJHRpbWVvdXQnLCBmdW5jdGlvbiAoJGh0dHAsICRxLCAkd2luZG93LCAkdGltZW91dCkge1xuICAgIHRoaXMudXBsb2FkcyA9IDA7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5nZXRVcGxvYWRPcHRpb25zID0gZnVuY3Rpb24gKHVyaSkge1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICRodHRwLmdldCh1cmkpLlxuICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uIChyZXNwb25zZSwgc3RhdHVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uIChlcnJvciwgc3RhdHVzKSB7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG5cbiAgICB0aGlzLnJhbmRvbVN0cmluZyA9IGZ1bmN0aW9uIChsZW5ndGgpIHtcbiAgICAgIHZhciBjaGFycyA9ICcwMTIzNDU2Nzg5YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWic7XG4gICAgICB2YXIgcmVzdWx0ID0gJyc7XG4gICAgICBmb3IgKHZhciBpID0gbGVuZ3RoOyBpID4gMDsgLS1pKSByZXN1bHQgKz0gY2hhcnNbTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKGNoYXJzLmxlbmd0aCAtIDEpKV07XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuXG4gICAgdGhpcy51cGxvYWQgPSBmdW5jdGlvbiAoc2NvcGUsIHVyaSwga2V5LCBhY2wsIHR5cGUsIGFjY2Vzc0tleSwgcG9saWN5LCBzaWduYXR1cmUsIGZpbGUpIHtcbiAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICBzY29wZS5hdHRlbXB0ID0gdHJ1ZTtcblxuICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICBmZC5hcHBlbmQoJ2tleScsIGtleSk7XG4gICAgICBmZC5hcHBlbmQoJ2FjbCcsIGFjbCk7XG4gICAgICBmZC5hcHBlbmQoJ0NvbnRlbnQtVHlwZScsIGZpbGUudHlwZSk7XG4gICAgICBmZC5hcHBlbmQoJ0FXU0FjY2Vzc0tleUlkJywgYWNjZXNzS2V5KTtcbiAgICAgIGZkLmFwcGVuZCgncG9saWN5JywgcG9saWN5KTtcbiAgICAgIGZkLmFwcGVuZCgnc2lnbmF0dXJlJywgc2lnbmF0dXJlKTtcbiAgICAgIGZkLmFwcGVuZChcImZpbGVcIiwgZmlsZSk7XG5cbiAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgIHhoci51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcihcInByb2dyZXNzXCIsIHVwbG9hZFByb2dyZXNzLCBmYWxzZSk7XG4gICAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgdXBsb2FkQ29tcGxldGUsIGZhbHNlKTtcbiAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgdXBsb2FkRmFpbGVkLCBmYWxzZSk7XG4gICAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcihcImFib3J0XCIsIHVwbG9hZENhbmNlbGVkLCBmYWxzZSk7XG4gICAgICBzY29wZS4kZW1pdCgnczN1cGxvYWQ6c3RhcnQnLCB4aHIpO1xuXG4gICAgICAvLyBEZWZpbmUgZXZlbnQgaGFuZGxlcnNcbiAgICAgIGZ1bmN0aW9uIHVwbG9hZFByb2dyZXNzKGUpIHtcbiAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoZS5sZW5ndGhDb21wdXRhYmxlKSB7XG4gICAgICAgICAgICBzY29wZS5wcm9ncmVzcyA9IE1hdGgucm91bmQoZS5sb2FkZWQgKiAxMDAgLyBlLnRvdGFsKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2NvcGUucHJvZ3Jlc3MgPSAndW5hYmxlIHRvIGNvbXB1dGUnO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgbXNnID0ge3R5cGU6ICdwcm9ncmVzcycsIHZhbHVlOiBzY29wZS5wcm9ncmVzc307XG4gICAgICAgICAgc2NvcGUuJGVtaXQoJ3MzdXBsb2FkOnByb2dyZXNzJywgbXNnKTtcbiAgICAgICAgICBpZiAodHlwZW9mIGRlZmVycmVkLm5vdGlmeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgZGVmZXJyZWQubm90aWZ5KG1zZyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gdXBsb2FkQ29tcGxldGUoZSkge1xuICAgICAgICB2YXIgeGhyID0gZS5zcmNFbGVtZW50IHx8IGUudGFyZ2V0O1xuICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHNlbGYudXBsb2Fkcy0tO1xuICAgICAgICAgIHNjb3BlLnVwbG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgIC8vemVybyBvdXQgcHJvZ3Jlc3MgZm9yIGFuaW1hdGlvblxuICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7c2NvcGUucHJvZ3Jlc3MgPSAwfSwgMzAwKTtcbiAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjA0KSB7IC8vIHN1Y2Nlc3NmdWwgdXBsb2FkXG4gICAgICAgICAgICBzY29wZS5zdWNjZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoeGhyKTtcbiAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdzM3VwbG9hZDpzdWNjZXNzJywgeGhyLCB7cGF0aDogdXJpICsga2V5fSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNjb3BlLnN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCh4aHIpO1xuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3MzdXBsb2FkOmVycm9yJywgeGhyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZnVuY3Rpb24gdXBsb2FkRmFpbGVkKGUpIHtcbiAgICAgICAgdmFyIHhociA9IGUuc3JjRWxlbWVudCB8fCBlLnRhcmdldDtcbiAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzZWxmLnVwbG9hZHMtLTtcbiAgICAgICAgICBzY29wZS51cGxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICBzY29wZS5zdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHhocik7XG4gICAgICAgICAgc2NvcGUuJGVtaXQoJ3MzdXBsb2FkOmVycm9yJywgeGhyKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBmdW5jdGlvbiB1cGxvYWRDYW5jZWxlZChlKSB7XG4gICAgICAgIHZhciB4aHIgPSBlLnNyY0VsZW1lbnQgfHwgZS50YXJnZXQ7XG4gICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi51cGxvYWRzLS07XG4gICAgICAgICAgc2NvcGUudXBsb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgc2NvcGUuc3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICAgIGRlZmVycmVkLnJlamVjdCh4aHIpO1xuICAgICAgICAgIHNjb3BlLiRlbWl0KCdzM3VwbG9hZDphYm9ydCcsIHhocik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZW5kIHRoZSBmaWxlXG4gICAgICBzY29wZS51cGxvYWRpbmcgPSB0cnVlO1xuICAgICAgdGhpcy51cGxvYWRzKys7XG4gICAgICB4aHIub3BlbignUE9TVCcsIHVyaSwgdHJ1ZSk7XG4gICAgICB4aHIuc2VuZChmZCk7XG5cbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH07XG5cbiAgICB0aGlzLmlzVXBsb2FkaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMudXBsb2FkcyA+IDA7XG4gICAgfTtcbiAgfV0pO1xuIl19;
'use strict';

angular.module('ngS3upload.directives', []).directive('s3Upload', ['$parse', 'S3Uploader', 'ngS3Config', function ($parse, S3Uploader, ngS3Config) {
  return {
    restrict: 'AC',
    require: '?ngModel',
    replace: true,
    transclude: false,
    scope: true,
    controller: ['$scope', '$element', '$attrs', '$transclude', function ($scope, $element, $attrs, $transclude) {
      $scope.attempt = false;
      $scope.success = false;
      $scope.uploading = false;
    }],
    compile: function compile(element, attr, linker) {
      return {
        pre: function pre($scope, $element, $attr) {
          if (angular.isUndefined($attr.bucket)) {
            throw Error('bucket is a mandatory attribute');
          }
        },
        post: function post(scope, element, attrs, ngModel) {
          // Build the opts array
          var opts = angular.extend({}, scope.$eval(attrs.s3UploadOptions || attrs.options));
          opts = angular.extend({
            submitOnChange: true,
            getOptionsUri: '/getS3Options',
            getManualOptions: null,
            mimeTypes: [],
            acl: 'public-read',
            uploadingKey: 'uploading',
            folder: '',
            buttonText: 'Select File',
            dropText: 'Drop File Here',
            errorText: 'Incorrect File Type',
            enableValidation: true,
            targetFilename: null
          }, opts);
          var bucket = scope.$eval(attrs.bucket);
          scope.buttonText = opts.buttonText;
          scope.dropText = opts.dropText;
          scope.errorText = opts.errorText;
          scope.displayError = false;

          // Bind the button click event
          var file = document.getElementById('s3-file-target'),
              filedrag = document.getElementById('s3-drop-target');

          filedrag.addEventListener('click', function (e) {
            file.click();
          });

          function Init() {
            // file drop
            filedrag.addEventListener('dragover', FileDragHover, false);
            filedrag.addEventListener('dragleave', FileDragHover, false);
            filedrag.addEventListener('drop', FileSelectHandler, false);
            filedrag.style.display = 'block';
          }

          function FileDragHover(e) {
            e.stopPropagation();
            e.preventDefault();
            e.target.className = e.type == 'dragover' ? 'hover' : '';
          }

          if (window.File && window.FileList && window.FileReader) {
            Init();
          }

          // file selection
          function FileSelectHandler(e) {

            // cancel event and hover styling
            FileDragHover(e);

            // fetch FileList object
            uploadFile((e.target.files || e.dataTransfer.files)[0]);
          }

          // Update the scope with the view value
          ngModel.$render = function () {
            scope.filename = ngModel.$viewValue;
          };

          function uploadFile(selectedFile) {
            var filename, mimeTypeMatch, ext;
            if (arguments.length === 0) {
              selectedFile = file.files[0];
            }
            filename = selectedFile.name;
            mimeTypeMatch = false;
            if (opts.mimeTypes.length > 0) {
              mimeTypeMatch = opts.mimeTypes.some(function (element) {
                if (selectedFile.type.match(element)) {
                  return true;
                }
                return false;
              });
            } else {
              mimeTypeMatch = true;
            }

            if (!mimeTypeMatch) {
              scope.displayError = true;
              return;
            }
            scope.displayError = false;
            ext = filename.split('.').pop();

            if (angular.isObject(opts.getManualOptions)) {
              _upload(opts.getManualOptions);
            } else {
              S3Uploader.getUploadOptions(opts.getOptionsUri).then(function (s3Options) {
                _upload(s3Options);
              }, function (error) {
                throw Error('Can\'t receive the needed options for S3 ' + error);
              });
            }

            function _upload(s3Options) {
              if (opts.enableValidation) {
                ngModel.$setValidity('uploading', false);
              }

              var s3Uri = 'https://' + bucket + '.s3.amazonaws.com/';
              var key = opts.folder + new Date().getTime() + '-' + S3Uploader.randomString(16) + '.' + ext;
              S3Uploader.upload(scope, s3Uri, key, opts.acl, selectedFile.type, s3Options.key, s3Options.policy, s3Options.signature, selectedFile).then(function () {
                ngModel.$setViewValue(s3Uri + key);
                scope.filename = ngModel.$viewValue;

                if (opts.enableValidation) {
                  ngModel.$setValidity('uploading', true);
                  ngModel.$setValidity('succeeded', true);
                }
              }, function () {
                scope.filename = ngModel.$viewValue;

                if (opts.enableValidation) {
                  ngModel.$setValidity('uploading', true);
                  ngModel.$setValidity('succeeded', false);
                }
              });
            }
          };

          element.bind('change', function (nVal) {
            if (opts.submitOnChange) {
              scope.$apply(function () {
                uploadFile();
              });
            }
          });

          if (angular.isDefined(attrs.doUpload)) {
            scope.$watch(attrs.doUpload, function (value) {
              if (value) uploadFile();
            });
          }
        }
      };
    },
    templateUrl: 'ng-easyS3.html'
  };
}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9uZy1lYXN5UzMvZGlyZWN0aXZlcy9uZy1lYXN5UzMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSxPQUFPLENBQUMsTUFBTSxDQUFDLHVCQUF1QixFQUFFLEVBQUUsQ0FBQyxDQUN6QyxTQUFTLENBQUMsVUFBVSxFQUFFLENBQUMsUUFBUSxFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsVUFBVSxNQUFNLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRTtBQUNyRyxTQUFPO0FBQ0wsWUFBUSxFQUFFLElBQUk7QUFDZCxXQUFPLEVBQUUsVUFBVTtBQUNuQixXQUFPLEVBQUUsSUFBSTtBQUNiLGNBQVUsRUFBRSxLQUFLO0FBQ2pCLFNBQUssRUFBRSxJQUFJO0FBQ1gsY0FBVSxFQUFFLENBQUMsUUFBUSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLFVBQVUsTUFBTSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFO0FBQzNHLFlBQU0sQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBQ3ZCLFlBQU0sQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBQ3ZCLFlBQU0sQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO0tBQzFCLENBQUM7QUFDRixXQUFPLEVBQUUsaUJBQVUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUU7QUFDeEMsYUFBTztBQUNMLFdBQUcsRUFBRSxhQUFVLE1BQU0sRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFO0FBQ3RDLGNBQUksT0FBTyxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUU7QUFDckMsa0JBQU0sS0FBSyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7V0FDaEQ7U0FDRjtBQUNELFlBQUksRUFBRSxjQUFVLEtBQUssRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRTs7QUFFOUMsY0FBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUs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QUMsQ0FBQztBQUN4Qyx5QkFBTyxDQUFDLFlBQVksQ0FBQyxXQUFXLEVBQUUsS0FBSyxDQUFDLENBQUM7aUJBQzFDO2VBQ0YsQ0FBQyxDQUFDO2FBQ047V0FDRixDQUFDOztBQUVGLGlCQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxVQUFVLElBQUksRUFBRTtBQUNyQyxnQkFBSSxJQUFJLENBQUMsY0FBYyxFQUFFO0FBQ3ZCLG1CQUFLLENBQUMsTUFBTSxDQUFDLFlBQVk7QUFDdkIsMEJBQVUsRUFBRSxDQUFDO2VBQ2QsQ0FBQyxDQUFDO2FBQ0o7V0FDRixDQUFDLENBQUM7O0FBRUgsY0FBSSxPQUFPLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsRUFBRTtBQUNyQyxpQkFBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLFVBQVMsS0FBSyxFQUFFO0FBQzNDLGtCQUFJLEtBQUssRUFBRSxVQUFVLEVBQUUsQ0FBQzthQUN6QixDQUFDLENBQUM7V0FDSjtTQUNGO09BQ0YsQ0FBQztLQUNIO0FBQ0QsZUFBVyxFQUFFLGdCQUFnQjtHQUM5QixDQUFDO0NBQ0gsQ0FBQyxDQUFDLENBQUMiLCJmaWxlIjoic3JjL25nLWVhc3lTMy9kaXJlY3RpdmVzL25nLWVhc3lTMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuYW5ndWxhci5tb2R1bGUoJ25nUzN1cGxvYWQuZGlyZWN0aXZlcycsIFtdKS5cbiAgZGlyZWN0aXZlKCdzM1VwbG9hZCcsIFsnJHBhcnNlJywgJ1MzVXBsb2FkZXInLCAnbmdTM0NvbmZpZycsIGZ1bmN0aW9uICgkcGFyc2UsIFMzVXBsb2FkZXIsIG5nUzNDb25maWcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVzdHJpY3Q6ICdBQycsXG4gICAgICByZXF1aXJlOiAnP25nTW9kZWwnLFxuICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgIHRyYW5zY2x1ZGU6IGZhbHNlLFxuICAgICAgc2NvcGU6IHRydWUsXG4gICAgICBjb250cm9sbGVyOiBbJyRzY29wZScsICckZWxlbWVudCcsICckYXR0cnMnLCAnJHRyYW5zY2x1ZGUnLCBmdW5jdGlvbiAoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkdHJhbnNjbHVkZSkge1xuICAgICAgICAkc2NvcGUuYXR0ZW1wdCA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuc3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUudXBsb2FkaW5nID0gZmFsc2U7XG4gICAgICB9XSxcbiAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uIChlbGVtZW50LCBhdHRyLCBsaW5rZXIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBwcmU6IGZ1bmN0aW9uICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cikge1xuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoJGF0dHIuYnVja2V0KSkge1xuICAgICAgICAgICAgICB0aHJvdyBFcnJvcignYnVja2V0IGlzIGEgbWFuZGF0b3J5IGF0dHJpYnV0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcG9zdDogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xuICAgICAgICAgICAgLy8gQnVpbGQgdGhlIG9wdHMgYXJyYXlcbiAgICAgICAgICAgIHZhciBvcHRzID0gYW5ndWxhci5leHRlbmQoe30sIHNjb3BlLiRldmFsKGF0dHJzLnMzVXBsb2FkT3B0aW9ucyB8fCBhdHRycy5vcHRpb25zKSk7XG4gICAgICAgICAgICBvcHRzID0gYW5ndWxhci5leHRlbmQoe1xuICAgICAgICAgICAgICBzdWJtaXRPbkNoYW5nZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZ2V0T3B0aW9uc1VyaTogJy9nZXRTM09wdGlvbnMnLFxuICAgICAgICAgICAgICBnZXRNYW51YWxPcHRpb25zOiBudWxsLFxuICAgICAgICAgICAgICBtaW1lVHlwZXM6IFtdLFxuICAgICAgICAgICAgICBhY2w6ICdwdWJsaWMtcmVhZCcsXG4gICAgICAgICAgICAgIHVwbG9hZGluZ0tleTogJ3VwbG9hZGluZycsXG4gICAgICAgICAgICAgIGZvbGRlcjogJycsXG4gICAgICAgICAgICAgIGJ1dHRvblRleHQ6ICdTZWxlY3QgRmlsZScsXG4gICAgICAgICAgICAgIGRyb3BUZXh0OiAnRHJvcCBGaWxlIEhlcmUnLFxuICAgICAgICAgICAgICBlcnJvclRleHQ6ICdJbmNvcnJlY3QgRmlsZSBUeXBlJyxcbiAgICAgICAgICAgICAgZW5hYmxlVmFsaWRhdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgdGFyZ2V0RmlsZW5hbWU6IG51bGxcbiAgICAgICAgICAgIH0sIG9wdHMpO1xuICAgICAgICAgICAgdmFyIGJ1Y2tldCA9IHNjb3BlLiRldmFsKGF0dHJzLmJ1Y2tldCk7XG4gICAgICAgICAgICBzY29wZS5idXR0b25UZXh0ID0gb3B0cy5idXR0b25UZXh0O1xuICAgICAgICAgICAgc2NvcGUuZHJvcFRleHQgPSBvcHRzLmRyb3BUZXh0O1xuICAgICAgICAgICAgc2NvcGUuZXJyb3JUZXh0ID0gb3B0cy5lcnJvclRleHQ7XG4gICAgICAgICAgICBzY29wZS5kaXNwbGF5RXJyb3IgPSBmYWxzZTtcblxuXG4gICAgICAgICAgICAvLyBCaW5kIHRoZSBidXR0b24gY2xpY2sgZXZlbnRcbiAgICAgICAgICAgIHZhciBmaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzMy1maWxlLXRhcmdldFwiKSxcbiAgICAgICAgICAgICAgZmlsZWRyYWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInMzLWRyb3AtdGFyZ2V0XCIpO1xuXG4gICAgICAgICAgICBmaWxlZHJhZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgIGZpbGUuY2xpY2soKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBJbml0KCkge1xuICAgICAgICAgICAgICAgIC8vIGZpbGUgZHJvcFxuICAgICAgICAgICAgICAgIGZpbGVkcmFnLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCBGaWxlRHJhZ0hvdmVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgZmlsZWRyYWcuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCBGaWxlRHJhZ0hvdmVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgZmlsZWRyYWcuYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgRmlsZVNlbGVjdEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBmaWxlZHJhZy5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gRmlsZURyYWdIb3ZlcihlKSB7XG4gICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgZS50YXJnZXQuY2xhc3NOYW1lID0gKGUudHlwZSA9PSBcImRyYWdvdmVyXCIgPyBcImhvdmVyXCIgOiBcIlwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHdpbmRvdy5GaWxlICYmIHdpbmRvdy5GaWxlTGlzdCAmJiB3aW5kb3cuRmlsZVJlYWRlcikge1xuICAgICAgICAgICAgICBJbml0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGZpbGUgc2VsZWN0aW9uXG4gICAgICAgICAgICBmdW5jdGlvbiBGaWxlU2VsZWN0SGFuZGxlcihlKSB7XG5cbiAgICAgICAgICAgICAgLy8gY2FuY2VsIGV2ZW50IGFuZCBob3ZlciBzdHlsaW5nXG4gICAgICAgICAgICAgIEZpbGVEcmFnSG92ZXIoZSk7XG5cbiAgICAgICAgICAgICAgLy8gZmV0Y2ggRmlsZUxpc3Qgb2JqZWN0XG4gICAgICAgICAgICAgIHVwbG9hZEZpbGUoKGUudGFyZ2V0LmZpbGVzIHx8IGUuZGF0YVRyYW5zZmVyLmZpbGVzKVswXSk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBzY29wZSB3aXRoIHRoZSB2aWV3IHZhbHVlXG4gICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHNjb3BlLmZpbGVuYW1lID0gbmdNb2RlbC4kdmlld1ZhbHVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gdXBsb2FkRmlsZShzZWxlY3RlZEZpbGUpIHtcbiAgICAgICAgICAgICAgdmFyIGZpbGVuYW1lLCBtaW1lVHlwZU1hdGNoLCBleHQ7XG4gICAgICAgICAgICAgIGlmKGFyZ3VtZW50cy5sZW5ndGggPT09IDApe1xuICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZSA9IGZpbGUuZmlsZXNbMF07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZmlsZW5hbWUgPSBzZWxlY3RlZEZpbGUubmFtZTtcbiAgICAgICAgICAgICAgbWltZVR5cGVNYXRjaCA9IGZhbHNlO1xuICAgICAgICAgICAgICBpZihvcHRzLm1pbWVUeXBlcy5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICBtaW1lVHlwZU1hdGNoID0gb3B0cy5taW1lVHlwZXMuc29tZShmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgICAgICAgICAgICAgIGlmKHNlbGVjdGVkRmlsZS50eXBlLm1hdGNoKGVsZW1lbnQpKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWltZVR5cGVNYXRjaCA9IHRydWU7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZighbWltZVR5cGVNYXRjaCl7XG4gICAgICAgICAgICAgICAgc2NvcGUuZGlzcGxheUVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgc2NvcGUuZGlzcGxheUVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgIGV4dCA9IGZpbGVuYW1lLnNwbGl0KCcuJykucG9wKCk7XG5cbiAgICAgICAgICAgICAgaWYoYW5ndWxhci5pc09iamVjdChvcHRzLmdldE1hbnVhbE9wdGlvbnMpKSB7XG4gICAgICAgICAgICAgICAgX3VwbG9hZChvcHRzLmdldE1hbnVhbE9wdGlvbnMpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFMzVXBsb2FkZXIuZ2V0VXBsb2FkT3B0aW9ucyhvcHRzLmdldE9wdGlvbnNVcmkpLnRoZW4oZnVuY3Rpb24gKHMzT3B0aW9ucykge1xuICAgICAgICAgICAgICAgICAgX3VwbG9hZChzM09wdGlvbnMpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJDYW4ndCByZWNlaXZlIHRoZSBuZWVkZWQgb3B0aW9ucyBmb3IgUzMgXCIgKyBlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBmdW5jdGlvbiBfdXBsb2FkKHMzT3B0aW9ucyl7XG4gICAgICAgICAgICAgICAgaWYgKG9wdHMuZW5hYmxlVmFsaWRhdGlvbikge1xuICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3VwbG9hZGluZycsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgczNVcmkgPSAnaHR0cHM6Ly8nICsgYnVja2V0ICsgJy5zMy5hbWF6b25hd3MuY29tLyc7XG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IG9wdHMuZm9sZGVyICsgKG5ldyBEYXRlKCkpLmdldFRpbWUoKSArICctJyArIFMzVXBsb2FkZXIucmFuZG9tU3RyaW5nKDE2KSArICcuJyArIGV4dDtcbiAgICAgICAgICAgICAgICBTM1VwbG9hZGVyLnVwbG9hZChzY29wZSxcbiAgICAgICAgICAgICAgICAgICAgczNVcmksXG4gICAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgICAgb3B0cy5hY2wsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZS50eXBlLFxuICAgICAgICAgICAgICAgICAgICBzM09wdGlvbnMua2V5LFxuICAgICAgICAgICAgICAgICAgICBzM09wdGlvbnMucG9saWN5LFxuICAgICAgICAgICAgICAgICAgICBzM09wdGlvbnMuc2lnbmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpbGVcbiAgICAgICAgICAgICAgICAgICkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHNldFZpZXdWYWx1ZShzM1VyaSArIGtleSk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmZpbGVuYW1lID0gbmdNb2RlbC4kdmlld1ZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLmVuYWJsZVZhbGlkYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgndXBsb2FkaW5nJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3N1Y2NlZWRlZCcsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmZpbGVuYW1lID0gbmdNb2RlbC4kdmlld1ZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLmVuYWJsZVZhbGlkYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWYWxpZGl0eSgndXBsb2FkaW5nJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kc2V0VmFsaWRpdHkoJ3N1Y2NlZWRlZCcsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGVsZW1lbnQuYmluZCgnY2hhbmdlJywgZnVuY3Rpb24gKG5WYWwpIHtcbiAgICAgICAgICAgICAgaWYgKG9wdHMuc3VibWl0T25DaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgdXBsb2FkRmlsZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGF0dHJzLmRvVXBsb2FkKSkge1xuICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goYXR0cnMuZG9VcGxvYWQsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB1cGxvYWRGaWxlKCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgICB0ZW1wbGF0ZVVybDogJ25nLWVhc3lTMy5odG1sJ1xuICAgIH07XG4gIH1dKTtcbiJdfQ==;
angular.module('ngS3upload').run(['$templateCache', function($templateCache) {
  'use strict';

  $templateCache.put('ng-easyS3.html',
    "<div class=\"upload-wrap\">\n" +
    "  <style scoped>\n" +
    "    #s3-drop-target{\n" +
    "      height: 100px;\n" +
    "      width: 100%;\n" +
    "      display: flex !important;\n" +
    "      flex-direction: column;\n" +
    "      justify-content: center;\n" +
    "      align-items: center;\n" +
    "      border-radius: 8px;\n" +
    "      border: 3px dashed #999;\n" +
    "      color: #999;\n" +
    "      font-size: 24px;\n" +
    "      font-weight: bold;\n" +
    "      text-transform: capitalize;\n" +
    "      background-color: rgb(238, 238, 238);\n" +
    "    }\n" +
    "\n" +
    "    #s3-drop-target.hover{\n" +
    "      border: 3px dashed #777;\n" +
    "      color: #777;\n" +
    "      background-color: rgb(225, 225, 225);\n" +
    "    }\n" +
    "\n" +
    "    #s3-drop-target:hover{\n" +
    "      border: 3px dashed #777;\n" +
    "      color: #777;\n" +
    "      background-color: rgb(225, 225, 225);\n" +
    "      cursor: pointer;\n" +
    "    }\n" +
    "\n" +
    "    .progress{\n" +
    "      margin-bottom: 0;\n" +
    "      height: 50%;\n" +
    "    }\n" +
    "\n" +
    "    .S3-front, .S3-back{\n" +
    "      display: flex;\n" +
    "      flex-direction: column;\n" +
    "      justify-content: center;\n" +
    "    }\n" +
    "\n" +
    "    /* entire container, keeps perspective */\n" +
    "    .S3-display {\n" +
    "      perspective: 1000;\n" +
    "      position: relative;\n" +
    "    }\n" +
    "    /* flip the pane when hovered */\n" +
    "    .S3-display.S3-uploading .S3-flipper {\n" +
    "      transform: rotateX(-180deg);\n" +
    "    }\n" +
    "\n" +
    "    .S3-display, .S3-front, .S3-back {\n" +
    "      width: 100%;\n" +
    "      height: 100px;\n" +
    "    }\n" +
    "\n" +
    "    /* flip speed goes here */\n" +
    "    .S3-flipper {\n" +
    "      transition: 0.3s;\n" +
    "      transform-style: preserve-3d;\n" +
    "      position: relative;\n" +
    "      transform-origin: 100% 50px; /* half of height */*/\n" +
    "    }\n" +
    "\n" +
    "    /* hide back of pane during swap */\n" +
    "    .S3-front, .S3-back {\n" +
    "      backface-visibility: hidden;\n" +
    "\n" +
    "      position: absolute;\n" +
    "      top: 0;\n" +
    "      left: 0;\n" +
    "    }\n" +
    "\n" +
    "    /* front pane, placed above back */\n" +
    "    .S3-front {\n" +
    "      z-index: 2;\n" +
    "      /* for firefox 31 */\n" +
    "      transform: rotateX(0deg);\n" +
    "    }\n" +
    "\n" +
    "    /* back, initially hidden pane */\n" +
    "    .S3-back {\n" +
    "      transform: rotateX(180deg);\n" +
    "    }\n" +
    "\n" +
    "\n" +
    "  </style>\n" +
    "  <div class=\"S3-display\" ng-class=\"{'S3-uploading': uploading}\">\n" +
    "    <div class=\"S3-flipper\">\n" +
    "      <div class=\"S3-front\">\n" +
    "        <div id=\"s3-drop-target\">\n" +
    "          <span>{{dropText}}</span>\n" +
    "          <span ng-show=\"displayError\" class=\"text-danger\"> File Type Error: {{errorText}}</span>\n" +
    "        </div>\n" +
    "      </div>\n" +
    "      <div class=\"S3-back\">\n" +
    "        <div class=\"progress\">\n" +
    "          <div class=\"progress-bar\" ng-class=\"{'active': uploading, 'bar-success': attempt && !uploading && success}\" role=\"progressbar\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: {{ progress }}%;\">\n" +
    "            <span class=\"sr-only\">{{progress}}% Complete</span>\n" +
    "          </div>\n" +
    "        </div>\n" +
    "      </div>\n" +
    "    </div>\n" +
    "  </div>\n" +
    "  <input type=\"file\" style=\"display: none\" id=\"s3-file-target\"/>\n" +
    "</div>\n"
  );

}]);
